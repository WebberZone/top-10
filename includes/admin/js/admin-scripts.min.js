jQuery(document).ready(function(t){function a(a,e){if(e){if(e.status_html){var n=a.closest("td").find(".tptn-fast-config-status").first();n.length||(n=t(".tptn-fast-config-status").first()),n.length&&n.replaceWith(t(e.status_html))}if(e.generate_nonce&&t(".tptn-generate-fast-config").data("nonce",e.generate_nonce),e.delete_nonce&&t(".tptn-delete-fast-config").data("nonce",e.delete_nonce),void 0!==e.has_config){var i=t(".tptn-delete-fast-config");i.length&&i.prop("disabled",!e.has_config)}e.message&&alert(e.message)}}t('button[name="tptn_cache_clear"]').on("click",function(){if(confirm(top_ten_admin_data.confirm_message)){var a=t(this),e=a.text(),n=top_ten_admin_data.clearing_text?top_ten_admin_data.clearing_text:"Clearing...";a.prop("disabled",!0).text(n).append(' <span class="spinner is-active"></span>'),function(a,e){t.post(top_ten_admin_data.ajax_url,{action:"tptn_clear_cache",security:top_ten_admin_data.security},function(t){t.success?alert(t.data.message):alert(top_ten_admin_data.fail_message)}).fail(function(t,a){alert(top_ten_admin_data.request_fail_message+a)}).always(function(){a&&a.length&&a.prop("disabled",!1).text(e).find(".spinner").remove()})}(a,e)}}),t("body").on("click",".tptn-generate-fast-config",function(){var e,n,i=t(this).data("confirm");confirm(i)&&(e=t(this),n=e.text(),e.prop("disabled",!0).text("Generating..."),t.post(top_ten_admin_data.ajax_url,{action:"tptn_generate_fast_config",security:e.data("nonce")},function(t){t&&t.data&&(t.data.nonce&&e.data("nonce",t.data.nonce),a(e,t.data))}).fail(function(t,a){window.console&&window.console.error&&window.console.error(top_ten_admin_data.request_fail_message+a)}).always(function(){e.prop("disabled",!1).text(n)}))}),t("body").on("click",".tptn-delete-fast-config",function(){var e,n,i=t(this).data("confirm");confirm(i)&&(e=t(this),n=e.text(),e.prop("disabled",!0).text("Deleting..."),t.post(top_ten_admin_data.ajax_url,{action:"tptn_delete_fast_config",security:e.data("nonce")},function(t){t&&t.data&&(t.data.nonce&&e.data("nonce",t.data.nonce),a(e,t.data))}).fail(function(t,a){window.console&&window.console.error&&window.console.error(top_ten_admin_data.request_fail_message+a)}).always(function(){e.text(n),e.data("nonce")&&e.prop("disabled",!1)}))}),t(function(){var a=t("#dashboard-historical-visits");a.tabs({create:function(a,e){t(e.tab.find("a")).addClass("nav-tab-active")},activate:function(a,e){t(e.oldTab.find("a")).removeClass("nav-tab-active"),t(e.newTab.find("a")).addClass("nav-tab-active")}}),setTimeout(function(){var e=a.tabs(),n=0;a.find(".nav-tab-wrapper li a").each(function(a){if(t(this).text().indexOf("Today")>=0)return n=a,!1}),e.tabs("option","active",n),a.find(".nav-tab-wrapper li a").removeClass("nav-tab-active"),a.find(".nav-tab-wrapper li").eq(n).find("a").addClass("nav-tab-active")},10)}),t(function(){var a="dd M yy",e=t("#datepicker-from").datepicker({changeMonth:!0,maxDate:0,dateFormat:a}).on("change",function(){n.datepicker("option","minDate",i(this))}),n=t("#datepicker-to").datepicker({changeMonth:!0,maxDate:0,dateFormat:a}).on("change",function(){e.datepicker("option","maxDate",i(this))});function i(e){var n;try{n=t.datepicker.parseDate(a,e.value)}catch(t){n=null}return n}}),t(".live_edit").on("click",function(){t(this).addClass("live_edit_mode").removeClass("live_edit_mode_success live_edit_mode_error")}),t(".live_edit").on("focusout keypress",function(a){if("focusout"===a.type||13===a.which){13==a.which&&a.preventDefault();var e=t(this),n=e.attr("data-wp-post-id"),i=e.attr("data-wp-blog-id"),o=e.attr("data-wp-count"),d=e.text();e.removeClass("live_edit_mode");var c={action:"tptn_edit_count_ajax",post_id:n,total_count:d,total_count_original:o,top_ten_admin_nonce:top_ten_admin.nonce};i&&(c.blog_id=i),t.ajax({type:"POST",dataType:"json",url:ajaxurl,data:c,success:function(t){!1===t?(e.addClass("live_edit_mode_error"),e.html(o)):t>0&&e.addClass("live_edit_mode_success")}})}})});