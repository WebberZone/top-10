jQuery(document).ready(function(t){function e(e,a){if(a){if(a.status_html){var n=e.closest("td").find(".tptn-fast-config-status").first();n.length||(n=t(".tptn-fast-config-status").first()),n.length&&n.replaceWith(t(a.status_html))}if(a.generate_nonce&&t(".tptn-generate-fast-config").data("nonce",a.generate_nonce),a.delete_nonce&&t(".tptn-delete-fast-config").data("nonce",a.delete_nonce),void 0!==a.has_config){var i=t(".tptn-delete-fast-config");i.length&&i.prop("disabled",!a.has_config)}a.message&&alert(a.message)}}t('button[name="tptn_cache_clear"]').on("click",function(){if(confirm(top_ten_admin_data.strings.confirm_message)){var e=t(this),a=e.text(),n=top_ten_admin_data.strings.clearing_text?top_ten_admin_data.strings.clearing_text:"Clearing...";e.prop("disabled",!0).text(n).append(' <span class="spinner is-active"></span>'),function(e,a){t.post(ajaxurl,{action:"tptn_clear_cache",security:top_ten_admin_data.security},function(t){t.success?alert(t.data.message):alert(top_ten_admin_data.strings.fail_message)}).fail(function(t,e){alert(top_ten_admin_data.strings.request_fail_message+e)}).always(function(){e&&e.length&&e.prop("disabled",!1).text(a).find(".spinner").remove()})}(e,a)}}),function(){var e=t('select[name="tptn_settings[tptn_styles]"]');if(e.length){var a=t('input[name="tptn_settings[post_thumb_op]"]');if(a.length){var n=top_ten_admin_data.strings||{},i={left_thumbs:{allowed:["inline","thumbs_only"],fallback:"inline",message:n.left_thumbs_message},grid_thumbs:{allowed:["inline","thumbs_only"],fallback:"inline",message:n.grid_thumbs_message||n.left_thumbs_message},text_only:{force:"text_only",disableAll:!0,message:n.text_only_message}};s(),e.on("change",s)}}function s(){var n,s=e.val(),o=a.filter(":checked"),c=i[s]||null;if((n=a.first().closest("td")).length||(n=a.first().parent()),n.find(".tptn-js-message").remove(),a.prop("disabled",!1),c){if(c.disableAll&&a.prop("disabled",!0),c.allowed&&c.allowed.length&&(a.each(function(){var e=t(this),a=e.val();-1===c.allowed.indexOf(a)&&e.prop("disabled",!0)}),!o.length||-1===c.allowed.indexOf(o.val()))){var d=c.fallback||c.allowed[0];a.filter('[value="'+d+'"]').prop("checked",!0)}c.force&&a.filter('[value="'+c.force+'"]').prop("checked",!0),c.message&&function(e){if(e){var n=a.first().closest("td");n.length||(n=a.first().parent());var i=n.find(".tptn-js-message");i.length?i.text(e):n.append(t("<p />",{class:"description tptn-js-message",css:{color:"#9B0800"},text:e}))}}(c.message)}}}(),t("body").on("click",".tptn-generate-fast-config",function(){var a,n,i=t(this).data("confirm");confirm(i)&&(a=t(this),n=a.text(),a.prop("disabled",!0).text("Generating..."),t.post(ajaxurl,{action:"tptn_generate_fast_config",security:a.data("nonce")},function(t){t&&t.data&&(t.data.nonce&&a.data("nonce",t.data.nonce),e(a,t.data))}).fail(function(t,e){window.console&&window.console.error&&window.console.error(top_ten_admin_data.strings.request_fail_message+e)}).always(function(){a.prop("disabled",!1).text(n)}))}),t("body").on("click",".tptn-delete-fast-config",function(){var a,n,i=t(this).data("confirm");confirm(i)&&(a=t(this),n=a.text(),a.prop("disabled",!0).text("Deleting..."),t.post(ajaxurl,{action:"tptn_delete_fast_config",security:a.data("nonce")},function(t){t&&t.data&&(t.data.nonce&&a.data("nonce",t.data.nonce),e(a,t.data))}).fail(function(t,e){window.console&&window.console.error&&window.console.error(top_ten_admin_data.strings.request_fail_message+e)}).always(function(){a.text(n),a.data("nonce")&&a.prop("disabled",!1)}))}),t(function(){var e=t("#dashboard-historical-visits");e.tabs({create:function(e,a){t(a.tab.find("a")).addClass("nav-tab-active")},activate:function(e,a){t(a.oldTab.find("a")).removeClass("nav-tab-active"),t(a.newTab.find("a")).addClass("nav-tab-active")}}),setTimeout(function(){var a=e.tabs(),n=0;e.find(".nav-tab-wrapper li a").each(function(e){if(t(this).text().indexOf("Today")>=0)return n=e,!1}),a.tabs("option","active",n),e.find(".nav-tab-wrapper li a").removeClass("nav-tab-active"),e.find(".nav-tab-wrapper li").eq(n).find("a").addClass("nav-tab-active")},10)}),t(function(){var e="dd M yy",a=t("#datepicker-from").datepicker({changeMonth:!0,maxDate:0,dateFormat:e}).on("change",function(){n.datepicker("option","minDate",i(this))}),n=t("#datepicker-to").datepicker({changeMonth:!0,maxDate:0,dateFormat:e}).on("change",function(){a.datepicker("option","maxDate",i(this))});function i(a){var n;try{n=t.datepicker.parseDate(e,a.value)}catch(t){n=null}return n}}),t(".live_edit").on("click",function(){t(this).addClass("live_edit_mode").removeClass("live_edit_mode_success live_edit_mode_error")}),t(".live_edit").on("focusout keypress",function(e){if("focusout"===e.type||13===e.which){13==e.which&&e.preventDefault();var a=t(this),n=a.attr("data-wp-post-id"),i=a.attr("data-wp-blog-id"),s=a.attr("data-wp-count"),o=a.text();a.removeClass("live_edit_mode");var c={action:"tptn_edit_count_ajax",post_id:n,total_count:o,total_count_original:s,top_ten_admin_nonce:top_ten_admin.nonce};i&&(c.blog_id=i),t.ajax({type:"POST",dataType:"json",url:ajaxurl,data:c,success:function(t){!1===t?(a.addClass("live_edit_mode_error"),a.html(s)):t>0&&a.addClass("live_edit_mode_success")}})}})});